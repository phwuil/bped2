import math
import random
import matplotlib.pyplot as plt
import numpy as np

#nb_people = [10,20,50,100,200,300,500,1000]
nb_people = [10,20,50,100,200,300,500,1000,1500,2000,2100,2200,2300,2400]
g = 4
gene_depart = 4

bn_2 = [0.004918718266666685, 0.009950923166666807, 0.028066718800000483, 0.0655771361999939, 0.13247646459999107, 0.2058786763666679, 0.414460136566701, 1.3334518019666575, 1.996829027366645, 3.142966900200433, 3.499856734633189, 3.806828042333412, 4.211717679300151, 4.467512441965664]
error_bn2 = [0.000603413140263863, 0.0011786733908658062, 0.0012212266028320895, 0.0036826209015752604, 0.0057830462576268895, 0.010633045434335988, 0.02006920074141061, 0.062017926820503326, 0.04430755944435331, 0.1700918196607351, 0.3517689633702416, 0.15476410864308632, 0.15213502551659322, 0.17910255763603913]
inf2 = [0.9565407701333337, 2.0077418704333345, 5.4742263964333295, 11.332644161999992, 23.893687189866657, 36.78843064033333, 66.05287966716674, 142.20488793436652, 217.22372940003328, 307.208624021067, 315.3401860170669, 336.84421979249964, 359.61730995333295, 347.913552978233]
error_inf2 = [0.10820167292689335, 0.12219034595650878, 0.37919371687873, 0.992271326576443, 1.6657356672500339, 3.454693092044199, 5.0804406406319815, 11.048654807895193, 12.227865441863516, 25.456579505274025, 23.44379542178642, 26.79598697350374, 26.116632930433724, 27.539416337141226]

f1 = plt.figure(1)
plt.errorbar(nb_people, bn_2, yerr = error_bn2,ecolor='red')
plt.title(f'Temps de génération du BN en fonction du pedigree avec {g} gènes')
plt.xlabel('Taille du pedigree')
plt.ylabel('Temps en sec')
plt.savefig(f'./MultiGen {g} Genes 30 samples')
f1.show()

f2 = plt.figure(2)
plt.errorbar(nb_people, inf2, yerr = error_inf2,ecolor='red')
plt.title(f'Calcul d\'inférence multi-allélique en fonction du pedigree avec {g} gènes')
plt.xlabel('Taille du pedigree')
plt.ylabel('Temps en sec')
plt.savefig(f'./MultiInf {g} Genes 30 samples')
f2.show()